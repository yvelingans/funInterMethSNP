% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Estim_methylation_curve.R
\name{estim_methyl_curve}
\alias{estim_methyl_curve}
\title{Estimate methylation curves per individual using adaptive Gaussian kernel smoothing}
\usage{
estim_methyl_curve(
  mat_methylation_raw,
  H = 1000,
  region_range = c(11190000, 11460000),
  RGN = seq(0, 1, length.out = 1000)
)
}
\arguments{
\item{mat_methylation_raw}{Data frame of raw methylation data. CpGs in rows, individuals in columns,
with a column named 'Position' indicating genomic positions (in base pairs).}

\item{H}{Numeric. Minimum bandwidth for adaptive kernel smoothing (default = 1000 bp).}

\item{region_range}{Numeric vector of length 2. Genomic region of interest: c(start_position, end_position).}

\item{RGN}{Numeric vector. Grid of values in [0,1] used for curve estimation
(default = seq(0,1,length.out = 1000)).}
}
\value{
A matrix of smoothed methylation curves with individuals in rows and grid points in columns.
}
\description{
This function estimates smoothed methylation trajectories for each individual
from raw methylation values in [0,1], using adaptive kernel smoothing based on CpG positions.
}
\examples{
\dontrun{
# Simulate methylation data for 3 individuals and 500 CpGs
set.seed(123)
n_cpg <- 500
n_ind <- 3

# Generate increasing positions within a fictional genomic region
positions <- sort(sample(11190000:11460000, n_cpg))

# Generate beta values between 0 and 1 for each individual
mat_beta <- matrix(runif(n_cpg * n_ind, min = 0, max = 1), ncol = n_ind)

# Combine beta values with Position column
mat_df <- as.data.frame(cbind(mat_beta, Position = positions))
colnames(mat_df) <- c(paste0("Ind", 1:n_ind), "Position")

# Apply the smoothing function
smoothed <- estim_methyl_curve(
  mat_methylation_raw = mat_df,
  H = 1000,
  region_range = c(11190000, 11460000),
  RGN = seq(0, 1, length.out = 100)
)
}
}
\references{
Hansen, K. D., Langmead, B., & Irizarry, R. A. (2012).
BSmooth: from whole genome bisulfite sequencing reads to differentially
methylated regions. \emph{Genome Biology}, 13, 1–10.

Lakhal-Chaieb, L., Greenwood, C. M. T., Ouhourane, M., Zhao, K., Abdous, B.,
& Oualkacha, K. (2017).
A smoothed EM-algorithm for DNA methylation profiles from sequencing-based
methods in cell lines or for a single cell type. \emph{Statistical Applications in
Genetics and Molecular Biology}, 16(5–6), 313–331.
}
